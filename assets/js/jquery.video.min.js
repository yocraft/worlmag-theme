/*! FAKTOR VIER Video Controller v0.1.3 | (c) 2015 FAKTOR VIER GmbH | http://faktorvier.ch */
function onYouTubeIframeAPIReady(){if(void 0!==$.video)for(callback_index in $.video.global.youtube_api_ready_callbacks)$.video.global.youtube_api_ready_callbacks[callback_index]()}var video_postmessage_event_func="attachEvent",video_postmessage_event="onmessage";window.addEventListener&&(video_postmessage_event_func="addEventListener",video_postmessage_event="message"),window[video_postmessage_event_func](video_postmessage_event,(function(e){if(!/^https?:\/\/player.vimeo.com/.test(e.origin))return!1;var t=JSON.parse(e.data),i=void 0===t.event?null:t.event,a=(void 0===t.method||t.method,$("#"+t.player_id)),o=a.getVideoConfig();switch(null==o&&(a.initVideo(),o=a.getVideoConfig()),i){case"ready":$.video.vimeo_postmessage(a,"addEventListener","play"),$.video.vimeo_postmessage(a,"addEventListener","pause"),$.video.vimeo_postmessage(a,"addEventListener","finish"),a.data("video-player",a),a.attr(o.attr_ready,""),a.trigger("ready"+$.video.global.event_suffix);break;case"play":a.removeAttr(o.attr_paused),a.attr(o.attr_playing,""),a.trigger("play"+$.video.global.event_suffix);break;case"pause":a.removeAttr(o.attr_playing),a.attr(o.attr_paused,""),a.trigger("pause"+$.video.global.event_suffix);break;case"finish":a.removeAttr(o.attr_playing),a.removeAttr(o.attr_paused),a.trigger("finish"+$.video.global.event_suffix)}}),!1),function(e){e.video={global:{event_suffix:"_video",youtube_api_ready_callbacks:[],youtube_iframe_api:"https://www.youtube.com/iframe_api"},config:{attr_ready:"data-video-ready",attr_playing:"data-video-playing",attr_paused:"data-video-paused"}};var t=function(t,i){var a=t.data("video").config;if(void 0===t.data("video-player")){var o=function(){var o=new YT.Player(t[0],{events:{onReady:function(e){t.attr(a.attr_ready,""),i(e.target)},onStateChange:function(i){switch(i.data){case 0:t.removeAttr(a.attr_paused),t.removeAttr(a.attr_playing),t.trigger("finish"+e.video.global.event_suffix);break;case 1:t.removeAttr(a.attr_paused),t.attr(a.attr_playing,""),t.trigger("play"+e.video.global.event_suffix);break;case 2:t.removeAttr(a.attr_playing),t.attr(a.attr_paused,""),t.trigger("pause"+e.video.global.event_suffix)}}}});t.data("video-player",o)};"undefined"==typeof YT||void 0===YT.Player?(e.video.global.youtube_api_ready_callbacks.push((function(){o()})),0==e('script[src="https://www.youtube.com/iframe_api"]').length&&0==e('script[src="http://www.youtube.com/iframe_api"]').length&&e("<script><\/script>").attr("src",e.video.global.youtube_iframe_api).insertBefore(e("script").first())):o()}else i(t.data("video-player"))},i=function(e,t){void 0!==e.data("video-player")&&t(e.data("video-player"))};e.video.vimeo_postmessage=function(e,t,i){var a={method:t};i&&(a.value=i),void 0!==e[0]&&e[0].contentWindow.postMessage(JSON.stringify(a),"*")},e.fn.getVideoConfig=function(){var t=e(this).first();return void 0!==t.data("video")?t.data("video").config:null},e.fn.getVideoPlayer=function(){var t=e(this).first();return void 0!==t.data("video-player")?t.data("video-player"):null},e.fn.getVideoType=function(){var t=e(this).first();return"video"==t.prop("tagName").toLowerCase()?video_type="video":-1!==t.attr("src").indexOf("youtube.com/embed")?video_type="youtube":-1!==t.attr("src").indexOf("player.vimeo.com/video")?video_type="vimeo":video_type="undefined",video_type},e.fn.initVideo=function(a){return this.each((function(){var o=e(this),r=o.getVideoType(),n=o.getVideoConfig();if(null!=n)return console.warn("Player already initialized!"),!1;if(n=e.extend(e.extend({},e.video.config),a),o.data("video",{config:n}),"youtube"==r)-1==o.attr("src").indexOf("enablejsapi=true")&&-1==o.attr("src").indexOf("enablejsapi=1")&&(-1==o.attr("src").indexOf("?")?o.attr("src",o.attr("src")+"?enablejsapi=1"):o.attr("src",o.attr("src")+"&enablejsapi=1"));else if("vimeo"==r&&(-1==o.attr("src").indexOf("api=true")&&-1==o.attr("src").indexOf("api=1")&&(-1==o.attr("src").indexOf("?")?o.attr("src",o.attr("src")+"?api=1"):o.attr("src",o.attr("src")+"&api=1")),-1==o.attr("src").indexOf("player_id="))){var d=o.attr("id");void 0===d&&(d="video-"+Math.round((new Date).getTime()+100*Math.random()),o.attr("id",d)),-1==o.attr("src").indexOf("?")?o.attr("src",o.attr("src")+"?player_id="+d):o.attr("src",o.attr("src")+"&player_id="+d)}"video"==r?(4==o.get(0).readyState?(o.attr(n.attr_ready,""),o.trigger("ready"+e.video.global.event_suffix)):o.get(0).addEventListener("canplaythrough",(function(){o.attr(n.attr_ready,""),o.trigger("ready"+e.video.global.event_suffix),o.get(0).removeEventListener("canplaythrough",this)}),!1),o.bind("play",(function(){o.removeAttr(n.attr_paused),o.attr(n.attr_playing,""),o.trigger("play"+e.video.global.event_suffix)})),o.bind("pause",(function(){o.removeAttr(n.attr_playing),o.attr(n.attr_paused,""),o.trigger("pause"+e.video.global.event_suffix)})),o.bind("ended",(function(){o.removeAttr(n.attr_playing),o.removeAttr(n.attr_paused),o.trigger("finish"+e.video.global.event_suffix)})),o.data("video-player",o[0])):"youtube"==r?t(o,(function(t){o.trigger("ready"+e.video.global.event_suffix)})):"vimeo"==r&&i(o,(function(t){o.trigger("ready"+e.video.global.event_suffix)}))}))},e.fn.playVideo=function(){return this.each((function(){var a=e(this),o=a.getVideoType(),r=a.getVideoPlayer();if(null==r)return console.warn("Player not initialized!"),!1;"video"==o?r.play():"youtube"==o?t(a,(function(e){e.playVideo()})):"vimeo"==o&&i(a,(function(t){e.video.vimeo_postmessage(t,"play")}))}))},e.fn.pauseVideo=function(){return this.each((function(){var a=e(this),o=a.getVideoType(),r=a.getVideoPlayer();if(null==r)return console.warn("Player not initialized!"),!1;"video"==o?r.pause():"youtube"==o?t(a,(function(e){e.pauseVideo()})):"vimeo"==o&&i(a,(function(t){e.video.vimeo_postmessage(t,"pause")}))}))},e.fn.stopVideo=function(){return this.each((function(){var a=e(this),o=a.getVideoType(),r=a.getVideoPlayer();if(null==r)return console.warn("Player not initialized!"),!1;"video"==o?(r.pause(),r.currentTime=0):"youtube"==o?t(a,(function(e){e.seekTo(e.getDuration())})):"vimeo"==o&&i(a,(function(t){e.video.vimeo_postmessage(t,"unload")}))}))},e.fn.restartVideo=function(){return this.each((function(){var a=e(this),o=a.getVideoType(),r=a.getVideoPlayer();a.getVideoConfig();if(null==r)return console.warn("Player not initialized!"),!1;"video"==o?(r.currentTime=0,r.play()):"youtube"==o?t(a,(function(t){t.seekTo(0),t.playVideo(),a.trigger("restart"+e.video.global.event_suffix)})):"vimeo"==o&&i(a,(function(t){e.video.vimeo_postmessage(t,"seekTo","0"),e.video.vimeo_postmessage(t,"play"),a.trigger("restart"+e.video.global.event_suffix)}))}))},e.fn.muteVideo=function(){return this.each((function(){var a=e(this),o=a.getVideoType(),r=a.getVideoPlayer();if(null==r)return console.warn("Player not initialized!"),!1;"video"==o?r.muted=!0:"youtube"==o?t(a,(function(e){e.mute()})):"vimeo"==o&&i(a,(function(t){e.video.vimeo_postmessage(t,"setVolume","0")}))}))},e.fn.unmuteVideo=function(){return this.each((function(){var a=e(this),o=a.getVideoType(),r=a.getVideoPlayer();if(null==r)return console.warn("Player not initialized!"),!1;"video"==o?r.muted=!1:"youtube"==o?t(a,(function(e){e.unMute()})):"vimeo"==o&&i(a,(function(t){e.video.vimeo_postmessage(t,"setVolume",1)}))}))},e.fn.seekToVideo=function(a){return this.each((function(){var o=e(this),r=o.getVideoType(),n=o.getVideoPlayer();if(null==n)return console.warn("Player not initialized!"),!1;"video"==r?n.currentTime=a:"youtube"==r?t(o,(function(e){e.seekTo(a)})):"vimeo"==r&&i(o,(function(t){e.video.vimeo_postmessage(t,"seekTo",a)}))}))},e.fn.destroyVideo=function(){return this.each((function(){var t=e(this),i=(t.getVideoType(),t.getVideoPlayer(),t.getVideoConfig());null!=i&&(t.removeData("video"),t.removeData("video-player"),t.removeAttr(i.attr_ready),t.removeAttr(i.attr_playing),t.removeAttr(i.attr_paused),t.trigger("destroy"+e.video.global.event_suffix))}))},e.fn.addVideoEvent=function(t,i){return this.each((function(){var a=e(this),o=a.getVideoType(),r=a.getVideoPlayer();"play"!=t||"video"!=o||void 0===a.get(0).paused||a.get(0).paused||i(null,a,o,r),a.bind(t+e.video.global.event_suffix,(function(e){i(e,a,o,r)}))}))},e.fn.removeVideoEvent=function(t){return this.each((function(){e(this).unbind(t+e.video.global.event_suffix)}))},e.fn.video=function(){var t="init",i={};return"string"==typeof arguments[0]?(t=arguments[0],i=arguments[1]):i=arguments[0],this.each((function(){var a=e(this);switch(t){case"init":a.initVideo(i);break;case"play":a.playVideo();break;case"pause":a.pauseVideo();break;case"stop":a.stopVideo();break;case"restart":a.restartVideo();break;case"mute":a.muteVideo();break;case"unmute":a.unmuteVideo();break;case"seekTo":a.seekToVideo(i);break;case"destroy":a.destroyVideo();break;case"addEvent":a.addVideoEvent(i[0],i[1]);break;case"removeEvent":a.removeVideoEvent(i[0]);break;default:console.warn('Video action "'+t+'" not found')}}))}}(jQuery);